diff '--color=auto' -ur typstyle-0.13.0/Cargo.lock typstyle-0.13.0_modified/Cargo.lock
--- typstyle-0.13.0/Cargo.lock	2025-02-22 12:36:02.000000000 +0800
+++ typstyle-0.13.0_modified/Cargo.lock	2025-02-23 19:07:42.675609927 +0800
@@ -1,6 +1,6 @@
 # This file is automatically @generated by Cargo.
 # It is not intended for manual editing.
-version = 4
+version = 3
 
 [[package]]
 name = "addr2line"
@@ -29,6 +29,18 @@
 ]
 
 [[package]]
+name = "ahash"
+version = "0.8.11"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "e89da841a80418a9b391ebaea17f5c112ffaaa96f621d2c285b5174da76b9011"
+dependencies = [
+ "cfg-if",
+ "once_cell",
+ "version_check",
+ "zerocopy",
+]
+
+[[package]]
 name = "aho-corasick"
 version = "1.1.3"
 source = "registry+https://github.com/rust-lang/crates.io-index"
@@ -1224,7 +1236,7 @@
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "8a9ee70c43aaf417c914396645a0fa852624801b24ebb7ae78fe8272889ac888"
 dependencies = [
- "ahash",
+ "ahash 0.7.8",
 ]
 
 [[package]]
@@ -1232,6 +1244,9 @@
 version = "0.14.5"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "e5274423e17b7c9fc20b6e7e208532f9b19825d82dfd615708b70edd83df41f1"
+dependencies = [
+ "ahash 0.8.11",
+]
 
 [[package]]
 name = "hashbrown"
@@ -1666,6 +1681,12 @@
 ]
 
 [[package]]
+name = "indexmap-nostd"
+version = "0.4.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "8e04e2fd2b8188ea827b32ef11de88377086d690286ab35747ef7f9bf3ccb590"
+
+[[package]]
 name = "inotify"
 version = "0.9.6"
 source = "registry+https://github.com/rust-lang/crates.io-index"
@@ -1770,6 +1791,15 @@
 
 [[package]]
 name = "kamadak-exif"
+version = "0.5.5"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "ef4fc70d0ab7e5b6bafa30216a6b48705ea964cdfc29c050f2412295eba58077"
+dependencies = [
+ "mutate_once",
+]
+
+[[package]]
+name = "kamadak-exif"
 version = "0.6.1"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "1130d80c7374efad55a117d715a3af9368f0fa7a2c54573afc15a188cd984837"
@@ -1809,9 +1839,9 @@
 
 [[package]]
 name = "libc"
-version = "0.2.169"
+version = "0.2.170"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "b5aba8db14291edd000dfcc4d620c7ebfb122c613afb886ca8803fa4e128a20a"
+checksum = "875b3680cb2f8f71bdcf9a30f38d48282f5d3c95cbf9b3fa57269bb5d5c06828"
 
 [[package]]
 name = "libm"
@@ -2007,6 +2037,17 @@
 checksum = "51d515d32fb182ee37cda2ccdcb92950d6a3c2893aa280e540671c2cd0f3b1d9"
 
 [[package]]
+name = "num-derive"
+version = "0.4.2"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "ed3955f1a9c7c0c15e092f9c887db08b1fc683305fdf6eb6684f22555355e202"
+dependencies = [
+ "proc-macro2",
+ "quote",
+ "syn 2.0.98",
+]
+
+[[package]]
 name = "num-integer"
 version = "0.1.46"
 source = "registry+https://github.com/rust-lang/crates.io-index"
@@ -2555,7 +2596,8 @@
 [[package]]
 name = "reflexo"
 version = "0.5.4"
-source = "git+https://github.com/paran3xus/typst.ts?rev=369f66dfab645d7a24d8307b9051b9839cfed72d#369f66dfab645d7a24d8307b9051b9839cfed72d"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "96b13fc37349d5c5bbf5d2ad365a55f2439d59deb78acb5578575b1d88cb8e66"
 dependencies = [
  "base64",
  "bitvec",
@@ -2574,15 +2616,14 @@
  "serde_with",
  "siphasher",
  "tiny-skia-path",
- "typst",
- "typst-pdf",
  "web-time",
 ]
 
 [[package]]
 name = "reflexo-typst"
 version = "0.5.4"
-source = "git+https://github.com/paran3xus/typst.ts?rev=369f66dfab645d7a24d8307b9051b9839cfed72d#369f66dfab645d7a24d8307b9051b9839cfed72d"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "94fe8e18c1d82e428e598c4099af771e7b1b3cc56e58ae5cd450867d595f95f1"
 dependencies = [
  "codespan-reporting",
  "comemo",
@@ -2604,31 +2645,31 @@
  "serde_json",
  "tar",
  "tokio",
- "typst",
- "typst-eval",
+ "typst 0.12.0",
 ]
 
 [[package]]
 name = "reflexo-typst-shim"
 version = "0.5.4"
-source = "git+https://github.com/paran3xus/typst.ts?rev=369f66dfab645d7a24d8307b9051b9839cfed72d#369f66dfab645d7a24d8307b9051b9839cfed72d"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "41e26fc8d9096f2ab25dabca6407544961172f1bd6b255668e5d3e91f2ded2c1"
 dependencies = [
  "cfg-if",
- "typst",
- "typst-syntax",
+ "typst 0.12.0",
+ "typst-syntax 0.12.0",
 ]
 
 [[package]]
 name = "reflexo-typst2vec"
 version = "0.5.4"
-source = "git+https://github.com/paran3xus/typst.ts?rev=369f66dfab645d7a24d8307b9051b9839cfed72d#369f66dfab645d7a24d8307b9051b9839cfed72d"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "b5f0f3aa5ce66a27c72a9baddeb0f46281d8e9ef6296bfd51cf7aec002c48e07"
 dependencies = [
  "bitvec",
  "comemo",
  "crossbeam-queue",
  "dashmap",
  "flate2",
- "image",
  "log",
  "parking_lot",
  "rayon",
@@ -2640,14 +2681,15 @@
  "tiny-skia",
  "tiny-skia-path",
  "ttf-parser",
- "typst",
+ "typst 0.12.0",
  "xmlparser",
 ]
 
 [[package]]
 name = "reflexo-vfs"
 version = "0.5.4"
-source = "git+https://github.com/paran3xus/typst.ts?rev=369f66dfab645d7a24d8307b9051b9839cfed72d#369f66dfab645d7a24d8307b9051b9839cfed72d"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "5513a7f75fc88d8cc4e151832f0596b0e925fa74aaf374351977df06c6ef6eb0"
 dependencies = [
  "indexmap 2.7.1",
  "log",
@@ -2655,13 +2697,14 @@
  "parking_lot",
  "reflexo",
  "rpds",
- "typst",
+ "typst 0.12.0",
 ]
 
 [[package]]
 name = "reflexo-world"
 version = "0.5.4"
-source = "git+https://github.com/paran3xus/typst.ts?rev=369f66dfab645d7a24d8307b9051b9839cfed72d#369f66dfab645d7a24d8307b9051b9839cfed72d"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "c9e30d61064c8821db1ace4da82b6129f19560f203430f20159f4e42ae025c19"
 dependencies = [
  "chrono",
  "codespan-reporting",
@@ -2683,7 +2726,7 @@
  "sha2",
  "strum",
  "tar",
- "typst",
+ "typst 0.12.0",
 ]
 
 [[package]]
@@ -2797,9 +2840,9 @@
 
 [[package]]
 name = "ring"
-version = "0.17.10"
+version = "0.17.11"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "d34b5020fcdea098ef7d95e9f89ec15952123a4a039badd09fabebe9e963e839"
+checksum = "da5349ae27d3887ca812fb375b45a4fbb36d8d12d2df394968cd86e35683fe73"
 dependencies = [
  "cc",
  "cfg-if",
@@ -3236,6 +3279,17 @@
 
 [[package]]
 name = "string-interner"
+version = "0.17.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "1c6a0d765f5807e98a091107bae0a56ea3799f66a5de47b2c84c94a39c09974e"
+dependencies = [
+ "cfg-if",
+ "hashbrown 0.14.5",
+ "serde",
+]
+
+[[package]]
+name = "string-interner"
 version = "0.18.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "1a3275464d7a9f2d4cac57c89c2ef96a8524dba2864c8d6f82e3980baf136f9b"
@@ -3724,6 +3778,75 @@
 
 [[package]]
 name = "typst"
+version = "0.12.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "87286a6b7e417426c425f35c42fb3d86e54ee99485b7eeb3662f4aeb569151c6"
+dependencies = [
+ "arrayvec 0.7.6",
+ "az",
+ "bitflags 2.8.0",
+ "bumpalo",
+ "chinese-number",
+ "ciborium",
+ "comemo",
+ "csv",
+ "ecow",
+ "flate2",
+ "fontdb",
+ "hayagriva",
+ "hypher",
+ "icu_properties",
+ "icu_provider",
+ "icu_provider_adapters",
+ "icu_provider_blob",
+ "icu_segmenter",
+ "if_chain",
+ "image",
+ "indexmap 2.7.1",
+ "kamadak-exif 0.5.5",
+ "kurbo",
+ "lipsum",
+ "log",
+ "once_cell",
+ "palette",
+ "phf",
+ "png",
+ "portable-atomic",
+ "qcms",
+ "rayon",
+ "regex",
+ "roxmltree",
+ "rust_decimal",
+ "rustybuzz",
+ "serde",
+ "serde_json",
+ "serde_yaml",
+ "siphasher",
+ "smallvec",
+ "stacker",
+ "syntect",
+ "time",
+ "toml",
+ "ttf-parser",
+ "two-face",
+ "typed-arena",
+ "typst-assets 0.12.0",
+ "typst-macros 0.12.0",
+ "typst-syntax 0.12.0",
+ "typst-timing 0.12.0",
+ "typst-utils 0.12.0",
+ "unicode-bidi",
+ "unicode-math-class",
+ "unicode-script",
+ "unicode-segmentation",
+ "unscanny",
+ "usvg",
+ "wasmi 0.35.0",
+ "xmlwriter",
+]
+
+[[package]]
+name = "typst"
 version = "0.13.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "1f7791c2c9984cb363bdc68009d4f8114bc2a7111a8214f96e26f75df9778063"
@@ -3734,15 +3857,21 @@
  "typst-html",
  "typst-layout",
  "typst-library",
- "typst-macros",
+ "typst-macros 0.13.0",
  "typst-realize",
- "typst-syntax",
- "typst-timing",
- "typst-utils",
+ "typst-syntax 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
 ]
 
 [[package]]
 name = "typst-assets"
+version = "0.12.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "4fe00da1b24da2c4a7da532fc33d0c3bd43a902ca4c408ee2c36eabe70f2f4ba"
+
+[[package]]
+name = "typst-assets"
 version = "0.13.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "1051c56bbbf74d31ea6c6b1661e62fa0ebb8104403ee53f6dcd321600426e0b6"
@@ -3760,10 +3889,10 @@
  "stacker",
  "toml",
  "typst-library",
- "typst-macros",
- "typst-syntax",
- "typst-timing",
- "typst-utils",
+ "typst-macros 0.13.0",
+ "typst-syntax 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
  "unicode-segmentation",
 ]
 
@@ -3776,11 +3905,11 @@
  "comemo",
  "ecow",
  "typst-library",
- "typst-macros",
+ "typst-macros 0.13.0",
  "typst-svg",
- "typst-syntax",
- "typst-timing",
- "typst-utils",
+ "typst-syntax 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
 ]
 
 [[package]]
@@ -3803,12 +3932,12 @@
  "rustybuzz",
  "smallvec",
  "ttf-parser",
- "typst-assets",
+ "typst-assets 0.13.0",
  "typst-library",
- "typst-macros",
- "typst-syntax",
- "typst-timing",
- "typst-utils",
+ "typst-macros 0.13.0",
+ "typst-syntax 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
  "unicode-bidi",
  "unicode-math-class",
  "unicode-script",
@@ -3838,7 +3967,7 @@
  "icu_provider_blob",
  "image",
  "indexmap 2.7.1",
- "kamadak-exif",
+ "kamadak-exif 0.6.1",
  "kurbo",
  "lipsum",
  "memchr",
@@ -3863,21 +3992,33 @@
  "ttf-parser",
  "two-face",
  "typed-arena",
- "typst-assets",
- "typst-macros",
- "typst-syntax",
- "typst-timing",
- "typst-utils",
+ "typst-assets 0.13.0",
+ "typst-macros 0.13.0",
+ "typst-syntax 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
  "unicode-math-class",
  "unicode-segmentation",
  "unscanny",
  "usvg",
- "wasmi",
+ "wasmi 0.40.0",
  "xmlwriter",
 ]
 
 [[package]]
 name = "typst-macros"
+version = "0.12.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "17b8b94b63e868e969e372929d6d3efb0d5f8cedad95a4f3aa460959f4544e0d"
+dependencies = [
+ "heck",
+ "proc-macro2",
+ "quote",
+ "syn 2.0.98",
+]
+
+[[package]]
+name = "typst-macros"
 version = "0.13.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "c748b2655e1cc5e68701b8b5e899b76aa8c046cb5f516ffcc0af3e2a25ed8d65"
@@ -3907,12 +4048,12 @@
  "subsetter",
  "svg2pdf",
  "ttf-parser",
- "typst-assets",
+ "typst-assets 0.13.0",
  "typst-library",
- "typst-macros",
- "typst-syntax",
- "typst-timing",
- "typst-utils",
+ "typst-macros 0.13.0",
+ "typst-syntax 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
  "xmp-writer",
 ]
 
@@ -3928,10 +4069,10 @@
  "ecow",
  "regex",
  "typst-library",
- "typst-macros",
- "typst-syntax",
- "typst-timing",
- "typst-utils",
+ "typst-macros 0.13.0",
+ "typst-syntax 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
 ]
 
 [[package]]
@@ -3948,8 +4089,8 @@
  "tiny-skia",
  "ttf-parser",
  "typst-library",
- "typst-macros",
- "typst-timing",
+ "typst-macros 0.13.0",
+ "typst-timing 0.13.0",
 ]
 
 [[package]]
@@ -3965,15 +4106,33 @@
  "image",
  "ttf-parser",
  "typst-library",
- "typst-macros",
- "typst-timing",
- "typst-utils",
+ "typst-macros 0.13.0",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
  "xmlparser",
  "xmlwriter",
 ]
 
 [[package]]
 name = "typst-syntax"
+version = "0.12.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "05b7be8b6ed6b2cb39ca495947d548a28d7db0ba244008e44c5a759120327693"
+dependencies = [
+ "ecow",
+ "once_cell",
+ "serde",
+ "toml",
+ "typst-utils 0.12.0",
+ "unicode-ident",
+ "unicode-math-class",
+ "unicode-script",
+ "unicode-segmentation",
+ "unscanny",
+]
+
+[[package]]
+name = "typst-syntax"
 version = "0.13.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "abe870e191c392cad35acff28095e99896033e3f2ddcd36b01bebc485e192711"
@@ -3981,8 +4140,8 @@
  "ecow",
  "serde",
  "toml",
- "typst-timing",
- "typst-utils",
+ "typst-timing 0.13.0",
+ "typst-utils 0.13.0",
  "unicode-ident",
  "unicode-math-class",
  "unicode-script",
@@ -3992,6 +4151,18 @@
 
 [[package]]
 name = "typst-timing"
+version = "0.12.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "175e7755eca10fe7d5a37a54cff50fbdf1a1becd55f35330ab783f5317c9eb96"
+dependencies = [
+ "parking_lot",
+ "serde",
+ "serde_json",
+ "typst-syntax 0.12.0",
+]
+
+[[package]]
+name = "typst-timing"
 version = "0.13.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "153d288af73d7d5f476a906a1984680b0f2c6020f15cd900243a5a8223cae4f2"
@@ -4003,6 +4174,19 @@
 
 [[package]]
 name = "typst-utils"
+version = "0.12.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "8f0305443ed97f0b658471487228f86bf835705e7525fbdcc671cebd864f7a40"
+dependencies = [
+ "once_cell",
+ "portable-atomic",
+ "rayon",
+ "siphasher",
+ "thin-vec",
+]
+
+[[package]]
+name = "typst-utils"
 version = "0.13.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "be823333fb1860b9f725f9e2bc848f2b85e4ef62fe94a793cd9500ad9ef554a9"
@@ -4028,7 +4212,7 @@
  "insta-cmd",
  "log",
  "tempfile",
- "typst-syntax",
+ "typst-syntax 0.13.0",
  "typstyle-core",
  "vergen",
  "vergen-gitcl",
@@ -4045,8 +4229,8 @@
  "pretty_assertions",
  "reflexo-typst",
  "reflexo-world",
- "typst",
- "typst-assets",
+ "typst 0.13.0",
+ "typst-assets 0.13.0",
  "typst-pdf",
  "typst-render",
  "walkdir",
@@ -4063,7 +4247,7 @@
  "pretty",
  "rustc-hash",
  "serde",
- "typst-syntax",
+ "typst-syntax 0.13.0",
  "wasm-bindgen",
 ]
 
@@ -4075,7 +4259,7 @@
  "insta",
  "libtest-mimic",
  "pretty_assertions",
- "typst-syntax",
+ "typst-syntax 0.13.0",
  "typstyle-consistency",
  "typstyle-core",
 ]
@@ -4409,6 +4593,23 @@
 
 [[package]]
 name = "wasmi"
+version = "0.35.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "dbaac6e702fa7b52258e5ac90d6e20a40afb37a1fbe7c645d0903ee42c5f85f4"
+dependencies = [
+ "arrayvec 0.7.6",
+ "multi-stash",
+ "num-derive",
+ "num-traits",
+ "smallvec",
+ "spin",
+ "wasmi_collections 0.35.0",
+ "wasmi_core 0.35.0",
+ "wasmparser-nostd",
+]
+
+[[package]]
+name = "wasmi"
 version = "0.40.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "a19af97fcb96045dd1d6b4d23e2b4abdbbe81723dbc5c9f016eb52145b320063"
@@ -4417,19 +4618,42 @@
  "multi-stash",
  "smallvec",
  "spin",
- "wasmi_collections",
- "wasmi_core",
+ "wasmi_collections 0.40.0",
+ "wasmi_core 0.40.0",
  "wasmi_ir",
  "wasmparser",
 ]
 
 [[package]]
 name = "wasmi_collections"
+version = "0.35.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "8ff59e30e550a509cc689ec638e5042be4d78ec9f6dd8a71fd02ee28776a74fd"
+dependencies = [
+ "ahash 0.8.11",
+ "hashbrown 0.14.5",
+ "string-interner 0.17.0",
+]
+
+[[package]]
+name = "wasmi_collections"
 version = "0.40.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "e80d6b275b1c922021939d561574bf376613493ae2b61c6963b15db0e8813562"
 dependencies = [
- "string-interner",
+ "string-interner 0.18.0",
+]
+
+[[package]]
+name = "wasmi_core"
+version = "0.35.0"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "13e10c674add0f92f47bf8ad57c55ee3ac1762a0d9baf07535e27e22b758a916"
+dependencies = [
+ "downcast-rs",
+ "libm",
+ "num-traits",
+ "paste",
 ]
 
 [[package]]
@@ -4448,7 +4672,7 @@
 source = "registry+https://github.com/rust-lang/crates.io-index"
 checksum = "6e431a14c186db59212a88516788bd68ed51f87aa1e08d1df742522867b5289a"
 dependencies = [
- "wasmi_core",
+ "wasmi_core 0.40.0",
 ]
 
 [[package]]
@@ -4462,6 +4686,15 @@
 ]
 
 [[package]]
+name = "wasmparser-nostd"
+version = "0.100.2"
+source = "registry+https://github.com/rust-lang/crates.io-index"
+checksum = "d5a015fe95f3504a94bb1462c717aae75253e39b9dd6c3fb1062c934535c64aa"
+dependencies = [
+ "indexmap-nostd",
+]
+
+[[package]]
 name = "web-sys"
 version = "0.3.77"
 source = "registry+https://github.com/rust-lang/crates.io-index"
diff '--color=auto' -ur typstyle-0.13.0/Cargo.toml typstyle-0.13.0_modified/Cargo.toml
--- typstyle-0.13.0/Cargo.toml	2025-02-22 12:36:02.000000000 +0800
+++ typstyle-0.13.0_modified/Cargo.toml	2025-02-23 19:13:59.563611493 +0800
@@ -76,10 +76,3 @@
 [profile.ci]
 inherits = "release"
 debug = true
-
-[patch.crates-io]
-# reflexo haven't released a new version for typst 0.13.0
-# These two lines can be removed when reflexo released a new version. Note that they are only
-# used in tests.
-reflexo-world = { git = "https://github.com/paran3xus/typst.ts", rev = "369f66dfab645d7a24d8307b9051b9839cfed72d" }
-reflexo-typst = { git = "https://github.com/paran3xus/typst.ts", rev = "369f66dfab645d7a24d8307b9051b9839cfed72d" }
